<!doctype html>
<meta charset="utf-8">
<link rel="stylesheet" href="bootstrap.min.css">
<script src="jquery.min.js"></script>
<script src="../λ.js"></script>
<script> lambda_fn_name = "λ_stable";</script>
<script src="λstable.js"></script>
<style>
div.test {
	margin:1em;
	padding:1em;
	border: 1px solid black;
}
.test.success {
	background-color:lightgreen;
}
.test.failed {
	background-color:#faa;
}
</style>
</style>
<div id=tests class="container">
	<script type=λ id="testtemplate">
		λtests->(
		<div class="test λsuccess?success:failed">
			<h4>Test λkey: λname</h4>
			<div>Template:
				<pre><code>λinput</code></pre>
			</div>
			λconfig?(
			<div>Config:
				<pre><code>λ(JSON.stringify(config,null,2))</code></pre>
			</div>)
			<div>Dataλpositional?( (Positional)) :
				<pre><code>λ(JSON.stringify(data,null,2))</code></pre>
			</div>
			<div>Expected Output:
				<pre><code>λoutput</code></pre>
			</div>
			λsuccess?(
				Success
			):(
				<div>Actual Output:
					<pre><code>λactualOutput</code></pre>
				</div>
				Failed
			)
		</div>
		)
	</script>
	<a href="sample.html">For a more complex example, see sample.html</a>
</div>
<script>
var tests = [
	{
		input:"no replacement",
		data:{},
		output:"no replacement",
	}, {
		input:"λsimpletext",
		data:{simpletext:"test sample"},
		output:"test sample"
	}, {
		input:"λfooλbar",
		data:{foo:"thing one",bar:"thing two"},
		output:"thing onething two"
	}, {
		name: "Simple array map",
		input:"λarr->( λkey:λval )",
		data:{arr:["a","b","c"]},
		output:" 0:a  1:b  2:c "
	}, {
		name: "Array map and join",
		input:"λarr.length things: λarr->(λkey:λval).join(', ')",
		data:{arr:["a","b","c"]},
		output:"3 things: 0:a, 1:b, 2:c"
	}, {
		name: "Positional args",
		config: {lambda:"%"},
		input:"%0 arguments work too: %0 1: %1, %0 2: %2",
		positional:true,
		data:["Positional","foo","bar"],
		output:"Positional arguments work too: Positional 1: foo, Positional 2: bar"
	}, {
		name: "Object map",
		input:"People: λpeople->(\nName: λfirstname λlastname, ID: λkey)",
		data:{people:{"ea386804":{firstname:"John",lastname:"Smith"},"b89b9144":{firstname:"Chuck",lastname:"Testa"}}},
		output:"People: \nName: John Smith, ID: ea386804\nName: Chuck Testa, ID: b89b9144"
	}
];
tests.forEach(function(test, index) {
	try {
		if(test.config) λ_fill.config(test.config);
		if(test.positional)
			test.actualOutput = λ_fill(test.input).apply(null,test.data);
		else 
			test.actualOutput = λ_fill(test.input, test.data);
		λ_fill.resetConfig();
		test.success = (test.output === test.actualOutput);
	} catch(e) {
		test.actualOutput = "ERR: " + e;
	}
});
λ_stable.inplace("testtemplate",tests);
</script>
